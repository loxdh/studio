
{
  "entities": {
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product in the United Love Luxe e-commerce store.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the product."
        },
        "name": {
          "type": "string",
          "description": "The name of the product."
        },
        "slug": {
          "type": "string",
          "description": "The slug of the product."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the product."
        },
        "price": {
          "type": "number",
          "description": "The price of the product."
        },
        "image": {
          "type": "string",
          "description": "ID of the product's placeholder image."
        },
        "categoryId": {
          "type": "string",
          "description": "Reference to Category. (Relationship: Category 1:N Product)"
        },
        "metaTitle": {
          "type": "string",
          "description": "SEO title for the product page."
        },
        "metaDescription": {
          "type": "string",
          "description": "SEO meta description for the product page."
        },
        "metaKeywords": {
          "type": "string",
          "description": "Comma-separated SEO keywords for the product page."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time when the product was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Date and time when the product was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "slug",
        "description",
        "price",
        "image",
        "categoryId",
        "createdAt",
        "updatedAt"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category of products.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the category."
        },
        "name": {
          "type": "string",
          "description": "The name of the category."
        },
        "description": {
          "type": "string",
          "description": "A description of the category."
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "BlogArticle": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BlogArticle",
      "type": "object",
      "description": "Represents a blog article for United Love Luxe.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the blog article."
        },
        "title": {
          "type": "string",
          "description": "The title of the blog article."
        },
        "content": {
          "type": "string",
          "description": "The HTML content of the blog article."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time when the blog article was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Date and time when the blog article was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "content",
        "createdAt",
        "updatedAt"
      ]
    },
    "adminRole": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "adminRole",
      "type": "object",
      "description": "Represents an admin user role.",
      "properties": {
        "isAdmin": {
          "type": "boolean",
          "description": "Flag indicating if the user is an admin."
        }
      },
      "required": [
        "isAdmin"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information. Admins can create, update, or delete products.",
          "params": [
            {
              "name": "productId",
              "description": "Unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores category information. Admins can create, update, or delete categories.",
          "params": [
            {
              "name": "categoryId",
              "description": "Unique identifier for the category."
            }
          ]
        }
      },
      {
        "path": "/blog_articles/{blogArticleId}",
        "definition": {
          "entityName": "BlogArticle",
          "schema": {
            "$ref": "#/backend/entities/BlogArticle"
          },
          "description": "Stores blog article content. Admins can create, update, or delete blog articles.",
          "params": [
            {
              "name": "blogArticleId",
              "description": "Unique identifier for the blog article."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "adminRole",
          "schema": {
            "$ref": "#/backend/entities/adminRole"
          },
          "description": "Stores documents representing admin users. The document ID is the user's UID. Existence grants admin privileges.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore data structure is designed to support the United Love Luxe e-commerce platform, focusing on products, categories, and blog articles, with a specific emphasis on enabling a functional admin dashboard. It prioritizes simplicity, security, and scalability using key principles:\n\n1. **Authorization Independence:**  Admin access is granted via the `/roles_admin/{uid}` collection. The existence of a document with the user's UID in this collection grants admin privileges.  This eliminates the need for complex `get()` calls in security rules and allows for atomic operations.\n\n2.  **Clarity of Intent:** The structure is explicit, with clear separation of data based on type and access requirements. The admin role is explicitly defined in a separate collection.\n\n3. **DBAC (Database Auth):** Roles are stored directly in the database, avoiding custom claims.  Security rules rely solely on `request.auth.uid` and the presence of a document in the `/roles_admin/{uid}` collection.\n\n4. **QAPs (Rules are Not Filters):** Secure list operations are supported via structural segregation.  Only admins can create/modify products because of the security rule that relies on the `/roles_admin/{uid}` collection.\n\n5.  **Invariants:** The structure supports data integrity by providing clear ownership and timestamp fields within the Product and BlogArticle entities.  The slug field in Product is not strictly enforced structurally but should be enforced at the application level.\n\n**Collection Structure Justification:**\n\n*   `/products`: Stores product information. Only admins can create, update, or delete products. This is enforced by checking for admin privileges via the `/roles_admin/{uid}` collection in the security rules. Includes the `categoryId` which references a document in the `categories` collection.\n*   `/categories`: Stores category information.  Only admins can create, update, or delete categories.  Similar to products, access is controlled via the `/roles_admin/{uid}` collection.\n*   `/blog_articles`: Stores blog article content.  Only admins can create, update, or delete blog articles. Admin privileges are enforced using the same mechanism as products and categories.\n*   `/roles_admin`: This collection stores documents representing admin users. The document ID is the user's UID. The existence of a document in this collection grants the user admin privileges."
  }
}
